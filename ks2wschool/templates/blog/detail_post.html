{% extends 'base.html' %}
{% load filter %}
{% load static %}
{% block content %}
    <link rel='stylesheet' href="{% static 'detail_post.css' %}?after=1320 ">
    <div id="post_head">
        <span class="s_post_head">zzz{{ post.category }}</span>    
    </div>
    <hr>
    <div id="post_main">
        <div id="post_writer"><span class="s_post_writer">ğŸ‘§ğŸ» {{ post.author }}</span></div>
        <div class="hits">
            <span class="s_hits">ì¡°íšŒìˆ˜ : {{post.hits}}</span> </div>
        <div id="post_title"><span class="s_post_title"> {{ post.title }}</></div>
        <hr/>
        <div id="content">{{ post.content|mark }}</div>
    </div>

    <div id="post_good">
        <a href="{% url 'post_vote' post.id %}">
            <button class ="s_post_good">ì¶”ì²œ {{post.voter.count}} ğŸ’—</button>
            {% if post.author == request.user %}  
                <button class="s_content_delete"> <a href="{% url 'blog_delete' post.id %}">ì‚­ì œ</a></button>
                <button class="s_content_again"> <a href="{% url 'blog_update' post.id %}">ìˆ˜ì •</a></button>
            {% endif %}
        </a>
    </div>
    <div class="comment-list">
        {% for comment in post.comment_set.all %}
            <div id="comment{{ comment.id }}">
                <div class="post-comment-author">- {{comment.author.nickname}}</div>
                <div class="post-comment-content comment-{{comment.id}}">
                    {{comment.content}}
                </div>
                <form action="{% url 'update_comment' comment.id %}" method="post" class="update-comment form-{{comment.id}} hide">
                    {% csrf_token %}
                    <textarea name="content" id="content-{{comment.id}}" class="update-comment-area" cols="30" rows="10">{{comment}}</textarea>
                    <input class="update_comment_btn" style="margin-left:20px;" type="submit" value="ìˆ˜ì •í•˜ê¸°">
                </form>
                <div class="post-comment-createdate">
                    {{ comment.create_date }}
                </div>
            {% if comment.author == request.user %}    
                <div class="post_button">
                    <button class="update_comment_btn" data-comment="{{comment.id}}">ìˆ˜ì •</button>
                    <button class="delete_comment_btn">ì‚­ì œ</button>
                </div>
            {% endif %}
            
            <div class="post_count"><span class="s_post_count">ë‹µê¸€ê°œìˆ˜ ({{ comment.reply_set.count }})</span></div>
        </div>
        {% endfor %}
    </div> 
{% endblock %}

{% block script %}
<script>
    $('.update_comment_btn').click(function(){
        if(this.innerHTML == 'ìˆ˜ì •'){
            this.innerHTML = 'ì·¨ì†Œ';
            $('.comment-' + this.dataset.comment).addClass('hide');
            $('.form-' + this.dataset.comment).removeClass('hide');
            // $('.form-1')
        }else{
            this.innerHTML = 'ìˆ˜ì •';
            $('.comment-' + this.dataset.comment).removeClass('hide');
            $('.form-' + this.dataset.comment).addClass('hide');
        }
        
    });

</script>
{% endblock %}

